import{I as C,L as S,r as f,H as D,K as L,aq as y,ar as I,m as g,q as _,s as o,P as u,ao as x,d as l,Q as v,J as r,F as B,al as A,ap as E,v as F}from"./index.d08fb49a.js";import{Q as N}from"./QChip.e9d9345f.js";import{Q}from"./QCardSection.85d38223.js";import{Q as U,a as $}from"./QForm.30c0a73b.js";import{Q as M}from"./QCard.27009715.js";import{Q as P}from"./QDialog.a666817a.js";import{u as R}from"./use-quasar.2a8b0abb.js";import"./use-dark.3cdab123.js";import"./use-key-composition.09b810f5.js";import"./use-prevent-scroll.6b7f661b.js";const T={class:"q-mb-xl",id:"ExhibitionView"},z={class:"img-section col-12"},H=["src"],J={class:"text-section co-12"},K={class:"col-12"},j={class:"q-mt-xl text-p"},G={class:"text-right"},O=o("h2",{class:"col-12"},"\u3010\u4ECB\u7D39\u3011",-1),W={class:"q-mb-xl q-pr-xxl text-p pre"},X={class:"small-image flex"},Y=["src"],ce={__name:"ExhibitionViewPage",setup(Z){const c=R(),m=E(),h=C(),{editCart:k}=h,{isLogin:q}=S(h),d=f(!1),p=f(0),i=f(!1),b={required(t){return!!t||"\u6B04\u4F4D\u5FC5\u586B"},number(t){return t>=0||"\u5FC5\u9808\u5927\u65BC0"}},w=()=>{k({_id:e._id,quantity:p.value}),d.value=!1},e=D({_id:"",title:"",name:"",from:"",to:"",place:"",description:"",image:void 0,images:[],delImages:[],price:0,sell:!0,map:void 0,category:""}),V=async()=>{var t,a;try{const{data:s}=await y.post("/users/love",{p_id:m.params.id,love:!i.value});i.value=!i.value,i.value===!0?c.notify({message:"\u52A0\u5165\u6536\u85CF",color:"pink"}):c.notify({message:"\u79FB\u9664\u6536\u85CF",color:"pink"})}catch(s){c.notify({message:"\u5931\u6557",caption:((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.message)||"\u767C\u751F\u932F\u8AA4",color:"pink"})}};return(async()=>{var a,s;const{data:t}=await L.get("/exhibitions/"+m.params.id);try{if(e._id=t.result._id,e.title=t.result.title,e.name=t.result.name,e.from=new Date(t.result.from).toLocaleDateString(),e.to=new Date(t.result.to).toLocaleDateString(),e.place=t.result.place,e.description=t.result.description.replace(/\\n/g,`
`),e.image=t.result.image,e.images=t.result.images,e.delImages=t.result.delImages,e.price=t.result.price,e.sell=t.result.sell,e.map=t.result.map,e.category=t.result.category,document.title="About | "+t.result.title,q.value){const{data:n}=await y.get("/users/love/"+m.params.id);i.value=n.result}console.log(t)}catch(n){c.notify({message:"\u53D6\u5F97\u5931\u6557",caption:((s=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:s.message)||"\u767C\u751F\u932F\u8AA4",color:"pink"}),I.go(-1)}})(),(t,a)=>(g(),_("div",T,[o("div",z,[o("img",{class:"img-width",src:e.image},null,8,H)]),o("div",J,[o("h1",K,u(e.title),1),o("p",j,[x(u(e.from+"~"+e.to),1),o("div",G,[l(v,{class:"btn",onClick:a[0]||(a[0]=s=>V({_id:e._id})),round:"",icon:i.value?"fa-solid fa-heart":"fa-regular fa-heart",color:"pink"},null,8,["icon"]),l(v,{class:"btn",onClick:a[1]||(a[1]=s=>d.value=!0),push:"",rounded:"",icon:"fa-solid fa-cart-shopping",label:"\u52A0\u5165\u8CFC\u7269\u8ECA",color:"pink"})])]),l(N,{color:"blue",size:"md"},{default:r(()=>[x("\uFF03"+u(e.category),1)]),_:1}),O,o("p",W,u(e.description),1)]),o("div",X,[(g(!0),_(B,null,A(e.images,s=>(g(),_("div",{class:"col-3",key:s},[o("img",{src:s},null,8,Y)]))),128))]),l(P,{modelValue:d.value,"onUpdate:modelValue":a[3]||(a[3]=s=>d.value=s)},{default:r(()=>[l(M,{style:{width:"60%"}},{default:r(()=>[l(U,{class:"row",onSubmit:F(w,["prevent"])},{default:r(()=>[l(Q,{class:"col-12"},{default:r(()=>[o("h6",null,u(e.title),1)]),_:1}),l(Q,{class:"col-12"},{default:r(()=>[l($,{modelValue:p.value,"onUpdate:modelValue":a[2]||(a[2]=s=>p.value=s),modelModifiers:{number:!0},type:"number",label:"\u8ACB\u9078\u64C7\u6578\u91CF",rules:[b.required,b.number]},null,8,["modelValue","rules"]),l(v,{class:"q-mt-lg",push:"",color:"pink",label:"\u52A0\u5165\u8CFC\u7269\u8ECA",type:"submit"})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]))}};export{ce as default};
