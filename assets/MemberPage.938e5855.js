import{Q as m}from"./QTd.9510121e.js";import{I as k,L as v,H as u,ar as f,m as q,q as C,s as n,d as o,J as s,Q as c}from"./index.ce5bf077.js";import{Q as B}from"./QTable.a75a2cf1.js";import{Q as d}from"./QCardSection.87cc17ff.js";import{Q as S,a as p}from"./QForm.77ae0701.js";import{Q as U}from"./QCard.10172644.js";import{Q as $}from"./QDialog.39dc39e9.js";import{u as A}from"./use-quasar.b9a44da6.js";import"./use-dark.b05c8d3d.js";import"./use-prevent-scroll.f1498f0f.js";import"./use-key-composition.b7664e18.js";import"./QChip.67d223a0.js";import"./selection.adec9789.js";import"./format.3e32b8d9.js";import"./QCheckbox.f681b1aa.js";const I={id:"AdminMember"},M=n("h4",{class:"text-center col-12"},"\u6703\u54E1\u7BA1\u7406",-1),T={class:"row q-px-xl"},N=["src"],D=n("div",{class:"text-h6"}," \u7DE8\u8F2F\u6703\u54E1",-1),ae={__name:"MemberPage",setup(E){const r=A(),b=k(),{account:g,email:_}=v(b),i=u([]),y=[{name:"image",label:"Avatar",align:"center"},{name:"account",label:"\u6703\u54E1",field:t=>t.account,align:"center"},{name:"email",label:"\u4FE1\u7BB1",field:t=>t.email,align:"center"},{name:"edit",label:"\u7DE8\u8F2F",align:"center"}],Q=()=>i.filter(t=>t.role!==!0),a=u({_id:"",account:g.value||"",email:_.value||"",dialog:!1,idx:-1}),h=t=>{a._id=i[t]._id,a.account=i[t].account,a.email=i[t].email,a.idx=t,a.dialog=!0},x=()=>{a._id="",a.account="",a.email="",a.dialog=!1},w=async()=>{var t,l;a.loading=!0;try{const{data:e}=await f.patch("/users/edituser",a);i[a.idx]=e.result,console.log(e),r.notify({message:"\u7DE8\u8F2F\u6210\u529F",color:"pink"}),a.dialog=!1}catch(e){r.notify({message:"\u64CD\u4F5C\u5931\u6557",caption:((l=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:l.message)||"\u767C\u751F\u932F\u8AA4",color:"pink"}),a.dialog=!1}a.loading=!1};return(async()=>{var t,l;try{const{data:e}=await f.get("/users/all");i.push(...e.result)}catch(e){r.notify({message:"\u53D6\u5F97\u5931\u6557",caption:((l=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:l.message)||"\u767C\u751F\u932F\u8AA4",color:"pink"})}})(),(t,l)=>(q(),C("div",I,[M,n("div",T,[o(B,{class:"item-center",rows:Q(),columns:y,"row-key":"_id",style:{width:"100%"}},{"body-cell-image":s(e=>[o(m,{class:"text-center"},{default:s(()=>[n("img",{src:`https://source.boringavatars.com/beam/${e.row.account}?colors=ffabab,ffdaab,ddffab,abe4ff,d9abff`,style:{width:"70px",height:"70px"}},null,8,N)]),_:2},1024)]),"body-cell-edit":s(e=>[o(m,{class:"text-center"},{default:s(()=>[o(c,{class:"q-ma-md",label:"\u7DE8\u8F2F",rounded:"",push:"",color:"blue",onClick:F=>h(i.findIndex(V=>V._id===e.row._id))},null,8,["onClick"])]),_:2},1024)]),_:1},8,["rows"])]),o($,{modelValue:a.dialog,"onUpdate:modelValue":l[3]||(l[3]=e=>a.dialog=e)},{default:s(()=>[o(U,{style:{width:"90%"}},{default:s(()=>[o(S,{onSubmit:w},{default:s(()=>[o(d,{class:"row item-center"},{default:s(()=>[D]),_:1}),o(d,null,{default:s(()=>[o(p,{class:"col-12 q-pb-lg",modelValue:a.account,"onUpdate:modelValue":l[0]||(l[0]=e=>a.account=e),filled:"",label:"\u8ACB\u8F38\u5165\u6703\u54E1\u5E33\u865F",type:"text"},null,8,["modelValue"]),o(p,{class:"col-12 q-pb-lg",modelValue:a.email,"onUpdate:modelValue":l[1]||(l[1]=e=>a.email=e),filled:"",label:"\u8ACB\u8F38\u5165\u6703\u54E1\u4FE1\u7BB1",type:"email"},null,8,["modelValue"])]),_:1}),o(d,{class:"text-right"},{default:s(()=>[o(c,{disabled:a.loading,flat:"",label:"submit",type:"submit",color:"blue"},null,8,["disabled"]),o(c,{onClick:l[2]||(l[2]=e=>x()),flat:"",label:"cancel",color:"pink"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{ae as default};
