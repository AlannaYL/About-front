import{Q as C}from"./QImg.3fdeb837.js";import{I as B,L as S,H as f,aq as p,m,q as r,s as n,F as I,al as U,d as l,J as s,ao as _,P as g,Q as u}from"./index.d08fb49a.js";import{Q as d}from"./QCardSection.85d38223.js";import{Q as b}from"./QCard.27009715.js";import{Q as $,a as h}from"./QForm.30c0a73b.js";import{Q as F}from"./QDialog.a666817a.js";import{u as N}from"./use-quasar.2a8b0abb.js";import"./use-dark.3cdab123.js";import"./use-key-composition.09b810f5.js";import"./use-prevent-scroll.6b7f661b.js";const A={id:"AdminMember"},D=n("h4",{class:"text-center col-12"},"\u6703\u54E1\u7BA1\u7406",-1),L={class:"row q-px-xl"},M={class:"column"},P={class:"text-h5 col q-my-md"},T={class:"text-subtitle2"},z=n("div",{class:"text-h6"}," \u7DE8\u8F2F\u6703\u54E1",-1),aa={__name:"MemberPage",setup(E){const c=N(),x=B(),{account:y,email:Q}=S(x),i=f([]),e=f({_id:"",account:y.value||"",email:Q.value||"",dialog:!1,idx:-1}),v=o=>{e._id=i[o]._id,e.account=i[o].account,e.email=i[o].email,e.idx=o,e.dialog=!0},V=()=>{e._id="",e.account="",e.email="",e.dialog=!1},k=async()=>{var o,t;e.loading=!0;try{const{data:a}=await p.patch("/users/edituser",e);i[e.idx]=a.result,console.log(a),c.notify({message:"\u7DE8\u8F2F\u6210\u529F",color:"pink"}),e.dialog=!1}catch(a){c.notify({message:"\u64CD\u4F5C\u5931\u6557",caption:((t=(o=a==null?void 0:a.response)==null?void 0:o.data)==null?void 0:t.message)||"\u767C\u751F\u932F\u8AA4",color:"pink"}),e.dialog=!1}e.loading=!1};return(async()=>{var o,t;try{const{data:a}=await p.get("/users/all");i.push(...a.result)}catch(a){c.notify({message:"\u53D6\u5F97\u5931\u6557",caption:((t=(o=a==null?void 0:a.response)==null?void 0:o.data)==null?void 0:t.message)||"\u767C\u751F\u932F\u8AA4",color:"pink"})}})(),(o,t)=>(m(),r("div",A,[D,n("div",L,[(m(!0),r(I,null,U(i,(a,q)=>(m(),r("div",{class:"q-pa-md items-center col-md-4 col-xs-12",key:q},[l(b,null,{default:s(()=>[l(d,{horizontal:""},{default:s(()=>[l(C,{class:"q-ma-md",src:`https://source.boringavatars.com/beam/${a.account}?colors=ffabab,ffdaab,ddffab,abe4ff,d9abff`,width:"70px",height:"70px"},null,8,["src"]),n("div",M,[n("div",P,[_(g(a.account),1),n("div",T,[_(g(a.email),1),l(u,{class:"q-ma-md",icon:"edit",round:"",push:"",color:"blue",onClick:H=>v(i.findIndex(w=>w._id===a._id))},null,8,["onClick"])])])])]),_:2},1024)]),_:2},1024)]))),128))]),l(F,{modelValue:e.dialog,"onUpdate:modelValue":t[3]||(t[3]=a=>e.dialog=a)},{default:s(()=>[l(b,{style:{width:"90%"}},{default:s(()=>[l($,{onSubmit:k},{default:s(()=>[l(d,{class:"row item-center"},{default:s(()=>[z]),_:1}),l(d,null,{default:s(()=>[l(h,{class:"col-12 q-pb-lg",modelValue:e.account,"onUpdate:modelValue":t[0]||(t[0]=a=>e.account=a),filled:"",label:"\u8ACB\u8F38\u5165\u6703\u54E1\u5E33\u865F",type:"text"},null,8,["modelValue"]),l(h,{class:"col-12 q-pb-lg",modelValue:e.email,"onUpdate:modelValue":t[1]||(t[1]=a=>e.email=a),filled:"",label:"\u8ACB\u8F38\u5165\u6703\u54E1\u4FE1\u7BB1",type:"email"},null,8,["modelValue"])]),_:1}),l(d,{class:"text-right"},{default:s(()=>[l(u,{disabled:e.loading,flat:"",label:"submit",type:"submit",color:"blue"},null,8,["disabled"]),l(u,{onClick:t[2]||(t[2]=a=>V()),flat:"",label:"cancel",color:"pink"})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{aa as default};
